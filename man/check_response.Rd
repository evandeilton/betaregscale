% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check-response.R
\name{check_response}
\alias{check_response}
\title{Transform and validate a scale-derived response variable}
\usage{
check_response(y, type = "m", ncuts = 100L, lim = 0.5, delta = NULL)
}
\arguments{
\item{y}{Numeric vector --- the raw response.}

\item{type}{\strong{Deprecated.}
Character: interval type.
\code{"m"} = midpoint (default),
\code{"l"} = left-aligned,
\code{"r"} = right-aligned.
Use \code{\link{bs_prepare}} to control interval geometry instead.}

\item{ncuts}{Integer: number of scale categories (default 100).}

\item{lim}{Numeric: half-width of the uncertainty region
(default 0.5).}

\item{delta}{Integer vector or \code{NULL}.  If \code{NULL}
(default), censoring types are inferred automatically from
boundary rules.  If provided, must have the same length as
\code{y} with values in \code{{0, 1, 2, 3}}.  When provided,
overrides the automatic classification.}
}
\value{
A matrix with columns \code{left}, \code{right},
  \code{yt} (midpoint approximation), \code{y} (original
  value), and \code{delta} (censoring indicator: 0 = exact,
  1 = left, 2 = right, 3 = interval).
}
\description{
Takes a discrete (or continuous) response on the scale
\eqn{0, 1, \ldots, K} (where \eqn{K =} \code{ncuts}) and converts
it to a pair of interval endpoints on the open unit interval
\eqn{(0, 1)}.  Each observation is classified into one of four
censoring types following the complete likelihood of Lopes (2024,
Eq. 2.24):

\describe{
  \item{\eqn{\delta = 0}}{Uncensored (exact): the observation is a
    continuous value already in \eqn{(0, 1)}.  The likelihood
    contribution is the density \eqn{f(y_i | \theta)}.}
  \item{\eqn{\delta = 1}}{Left-censored: the observation equals the
    scale minimum (\eqn{y = 0}).  We only know that the latent
    value is below some upper bound.  The contribution is
    \eqn{F(u_i | \theta)}.}
  \item{\eqn{\delta = 2}}{Right-censored: the observation equals the
    scale maximum (\eqn{y = K}).  The contribution is
    \eqn{1 - F(l_i | \theta)}.}
  \item{\eqn{\delta = 3}}{Interval-censored: the standard case for
    scale data.  The contribution is
    \eqn{F(u_i | \theta) - F(l_i | \theta)}.}
}
}
\details{
If the input is already in \eqn{(0, 1)} (i.e., all values satisfy
\eqn{0 < y < 1}), observations are treated as uncensored
(\eqn{\delta = 0}), unless \code{delta} is provided.

If \code{delta} is supplied, the user-provided censoring indicators
are used directly, overriding the automatic boundary-based
classification rules.

For scale (integer) data (when \code{delta = NULL}):
\itemize{
  \item \eqn{y = 0}: left-censored. Upper bound is
    \eqn{u = \mathrm{lim} / K}.
  \item \eqn{y = K}: right-censored. Lower bound is
    \eqn{l = (K - \mathrm{lim}) / K}.
  \item \eqn{0 < y < K}: interval-censored with endpoints determined
    by the interval \code{type}.
}

Three interval types (Section 2.7, Figure 4 of Lopes, 2024):
\describe{
  \item{\code{"m"} (midpoint)}{Symmetric: \eqn{l = (y - \mathrm{lim})/K},
    \eqn{u = (y + \mathrm{lim})/K}.}
  \item{\code{"l"} (left)}{Shifted left: \eqn{l = (y - 2\mathrm{lim})/K},
    \eqn{u = y/K}.}
  \item{\code{"r"} (right)}{Shifted right: \eqn{l = y/K},
    \eqn{u = (y + 2\mathrm{lim})/K}.}
}

All endpoints are clamped to \eqn{[\epsilon, 1 - \epsilon]} with
\eqn{\epsilon = 10^{-5}} to avoid boundary issues in the beta
likelihood.
}
\examples{
# Scale data with boundary observations
y <- c(0, 3, 5, 7, 9, 10)
check_response(y, ncuts = 10)

# Force all observations to be exact (delta = 0)
check_response(y, ncuts = 10, delta = rep(0L, length(y)))

}
